<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Parentheses checker</title>
<script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
</head>

<body style="padding: 60px;">
<label for="">String</label><br><br>
<input style="font-size: 25px; padding: 10px; width: 40%;" type="text" id="stringValue"> <br><br><br>
<button onclick="testFunction()" style="font-size: 20px; padding: 10px; cursor: pointer;" id="check">Check the string</button>
</body>

<script>


function testFunction() {

    let string =  $('#stringValue').val();
    let stringArray = string.split("");

    let brackets = { '(':'open P' , ')':'close P' , '{':'open C' , '}':'close C' };
    let results = [];
    let finalStatus = false;
    let hasBracketPairsCorrectly = false;


    for (let stringArrayindex = 0; stringArrayindex < stringArray.length; stringArrayindex++) {
    
        for (let key in brackets) {

            if(stringArray[stringArrayindex] === key){
                results.push(brackets[key]);
            }
        }
    }

    if ((results.length > 0) && (results.length % 2 == 0)) {

        // checking identified pattern

        var mappedResults = results.map((x, i) => i % 2 == 0 && results.slice(i, i + 2)).filter(x => x);

        console.log(mappedResults.length);

        for (let index = 0; index < mappedResults.length; index++) {

            let bracketTypeOpenTag = "open " + mappedResults[index][0].slice(-1);
            let bracketTypeCloseTag = "close " + mappedResults[index][0].slice(-1);

            if(jQuery.inArray(bracketTypeOpenTag , mappedResults[index]) != -1  &&  jQuery.inArray(bracketTypeCloseTag , mappedResults[index]) != -1){
                hasBracketPairsCorrectly = true;
            }

        }

        // not catched a simple bracket open and close pattern,

        if (hasBracketPairsCorrectly == false) {

            const middleIndex = Math.floor(results.length / 2);
            const firstArrayGroup = results.slice(0, middleIndex);
            const secondArrayGroup = results.slice(middleIndex);
            let firstArrayHasCloseTag = false;
            let secondArrayHasOpenTag = false;

            console.log( firstArrayGroup , secondArrayGroup );

            if (firstArrayGroup[0].startsWith("close")){
                console.log("1");
                return alert(false);
            }

            let secondArrayGroupIndex =  secondArrayGroup.length -1;

            for (let index = 0; index < firstArrayGroup.length; index++) {

                let firstOpenValue = "open " + firstArrayGroup[index].slice(-1);
                let firstCloseValue = "close " + firstArrayGroup[index].slice(-1);
                let secondOpenValue = "open " + firstArrayGroup[index].slice(-1);
                let secondCloseValue = "close " + firstArrayGroup[index].slice(-1);
    
                console.log( firstOpenValue , secondCloseValue , firstCloseValue , secondOpenValue  );
                

                if(!(
                    (firstArrayGroup[index] == firstOpenValue && secondArrayGroup[secondArrayGroupIndex] == secondCloseValue) 
                    || (firstArrayGroup[index] == firstCloseValue && secondArrayGroup[secondArrayGroupIndex] == secondOpenValue) 
                    )){

                // console.log(3);
                return alert(false);
                }
    
                secondArrayGroupIndex--;

            }
            
        }else{
            return alert(true);
        }

        return alert(true);

    }else{

        return alert(false);
    } 
}



// function getOpenAndCloseBracketIndex(openBracket , closeBracket){

//     var string =  $('#stringValue').val();
//     var openBracket = openBracket;
//     var closeBracket =  closeBracket;

//     var openBracketIndex = string.indexOf(openBracket) +1 ;
//     var closeBracketIndex = string.indexOf(closeBracket) +1 ;
    
//     return [openBracketIndex , closeBracketIndex ];
// }


// function stringValidator() {

//     var string =  $('#stringValue').val();
    
//     if(string.length != 0){

//         var paranthesesIndexes = getOpenAndCloseBracketIndex("(" , ")");

//         if( (paranthesesIndexes[0] != 0 && paranthesesIndexes[1] != 0) && (paranthesesIndexes[0] < paranthesesIndexes[1])){ 
//             return alert(true);
//         }else{
//             return alert(false);
//         }

//     }else{

//         return alert("Input field is empty please give a string!");
//     }
// }

</script>
</html>
